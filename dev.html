<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel do Desenvolvedor (GOD MODE)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --cor-fundo: #0d1117; --cor-card: #161b22; --cor-borda: #30363d; --cor-texto: #c9d1d9; --verde: #238636; --azul: #58a6ff; }
        * { box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background: var(--cor-fundo); color: var(--cor-texto); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        
        .container { background: var(--cor-card); border: 1px solid var(--cor-borda); padding: 40px; border-radius: 10px; width: 100%; max-width: 500px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h1 { margin-top: 0; color: var(--azul); font-size: 1.5rem; text-align: center; }
        
        label { display: block; margin-top: 15px; font-size: 0.9rem; color: #8b949e; }
        input { width: 100%; padding: 12px; background: #0d1117; border: 1px solid var(--cor-borda); color: white; border-radius: 6px; margin-top: 5px; outline: none; transition: 0.3s; }
        input:focus { border-color: var(--azul); }
        
        .btn-criar { width: 100%; padding: 15px; margin-top: 25px; background: var(--verde); color: white; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-criar:hover { opacity: 0.9; }

        .resultado { margin-top: 30px; padding: 15px; background: rgba(88, 166, 255, 0.1); border: 1px solid var(--azul); border-radius: 6px; display: none; }
        .link-box { background: #0d1117; padding: 10px; margin-top: 5px; border-radius: 4px; font-family: monospace; word-break: break-all; color: var(--azul); cursor: pointer; }
        small { display: block; margin-top: 20px; text-align: center; color: #484f58; }
    </style>
</head>
<body>

    <div class="container">
        <h1>游 F치brica de Lojas</h1>
        
        <label>Nome da Barbearia</label>
        <input type="text" id="nome-loja" placeholder="Ex: Barbearia do Z칠">

        <label>ID da URL (Slug)</label>
        <input type="text" id="id-loja" placeholder="Ex: ze_barber (sem espa칞os)">
        <p style="font-size:0.7rem; color:#666">Este ser치 o c칩digo 칰nico da loja no banco de dados.</p>

        <button class="btn-criar" onclick="criarNovaLoja()">CRIAR LOJA</button>

        <div id="resultado" class="resultado">
            <h3 style="margin-top:0; color:var(--verde)">Loja Criada com Sucesso!</h3>
            
            <label>Link para o Cliente (App):</label>
            <div class="link-box" onclick="copiar(this)" id="link-app">...</div>
            
            <label>Link para o Dono (Admin):</label>
            <div class="link-box" onclick="copiar(this)" id="link-admin">...</div>
        </div>
        
        <small>Desenvolvedor Master v1.0</small>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // *** IMPORTANTE: COLE SUAS CHAVES AQUI ***
        const firebaseConfig = {
            apiKey: "SUA_API_KEY_AQUI", // <--- COLE SUA CHAVE AQUI
            authDomain: "SEU_PROJETO.firebaseapp.com",
            projectId: "SEU_PROJETO",
            storageBucket: "SEU_PROJETO.appspot.com",
            messagingSenderId: "SEU_SENDER_ID",
            appId: "SEU_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // SENHA DE PROTE칂츾O (Simples)
        const SENHA_DEV = "mestre123";
        const entrada = prompt("Senha do Desenvolvedor:");
        if(entrada !== SENHA_DEV) { document.body.innerHTML = "<h1 style='color:red; text-align:center'>ACESSO NEGADO</h1>"; }

        // Formatar ID automaticamente (remove espa칞os e acentos)
        document.getElementById('nome-loja').addEventListener('input', (e) => {
            const val = e.target.value;
            const slug = val.toLowerCase().replace(/ /g, '_').replace(/[^\w-]+/g, '');
            document.getElementById('id-loja').value = slug;
        });

        window.criarNovaLoja = async function() {
            const nome = document.getElementById('nome-loja').value;
            const id = document.getElementById('id-loja').value;
            const btn = document.querySelector('.btn-criar');

            if(!nome || !id) return alert("Preencha tudo!");

            btn.innerText = "Criando Banco de Dados...";
            btn.disabled = true;

            try {
                // Verifica se j치 existe
                const docRef = doc(db, "lojas", id);
                const docSnap = await getDoc(docRef);

                if(docSnap.exists()) {
                    alert("ERRO: J치 existe uma loja com esse ID! Escolha outro.");
                    btn.innerText = "CRIAR LOJA";
                    btn.disabled = false;
                    return;
                }

                // Cria a configura칞칚o padr칚o no Firebase
                const configPadrao = {
                    nome: nome,
                    criado_em: new Date(),
                    horarioInicio: 9,
                    horarioFim: 19,
                    intervaloMinutos: 45,
                    servicos: [
                        { id: 0, nome: "Corte Masculino", preco: "R$ 35,00" },
                        { id: 1, nome: "Barba", preco: "R$ 25,00" }
                    ]
                };

                await setDoc(docRef, configPadrao);

                // Mostra os links
                const baseUrl = window.location.origin; // Pega o link atual do site (ex: https://vercel...)
                document.getElementById('link-app').innerText = `${baseUrl}/index.html?loja=${id}`;
                document.getElementById('link-admin').innerText = `${baseUrl}/admin.html?loja=${id}`;
                
                document.getElementById('resultado').style.display = 'block';
                btn.innerText = "LOJA CRIADA!";
                
            } catch (error) {
                console.error(error);
                alert("Erro: " + error.message);
                btn.innerText = "TENTAR NOVAMENTE";
                btn.disabled = false;
            }
        }

        window.copiar = function(elemento) {
            navigator.clipboard.writeText(elemento.innerText);
            alert("Link copiado!");
        }
    </script>
</body>
</html>