<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Teste de Conex√£o</title>
    <style>body{font-family:sans-serif; padding:40px; background:#f0f0f0; color:#333}</style>
</head>
<body>
    <h1>üïµÔ∏è Diagn√≥stico do Sistema</h1>
    <div id="status" style="background:white; padding:20px; border-radius:10px; border:1px solid #ccc;">
        <p>Iniciando testes...</p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- COLE SUAS CHAVES AQUI ---
        const firebaseConfig = {
  apiKey: "AIzaSyCEAeMxXbX047DhHYyAI-r4I_4eqlGA4W0",
  authDomain: "appbarbeariapiloto.firebaseapp.com",
  projectId: "appbarbeariapiloto",
  storageBucket: "appbarbeariapiloto.firebasestorage.app",
  messagingSenderId: "132643765315",
  appId: "1:132643765315:web:60568343cecfa5720268f6"
};appId: "1:132643765315:web:60568343cecfa5720268f6"
        };

        const statusDiv = document.getElementById('status');
        function log(msg, cor="black") {
            statusDiv.innerHTML += `<p style="color:${cor}; font-weight:bold;">${msg}</p>`;
        }

        async function testar() {
            log("1. Tentando conectar ao Firebase...");
            
            try {
                const app = initializeApp(firebaseConfig);
                const db = getFirestore(app);
                log("‚úÖ Firebase inicializado!", "green");

                log("2. Verificando Banco de Dados...");
                const docRef = doc(db, "lojas", "teste_conexao");
                
                // Tenta gravar algo para ver se tem permiss√£o
                await setDoc(docRef, { teste: true, data: new Date() });
                log("‚úÖ Conex√£o de Escrita: SUCESSO! O banco est√° acess√≠vel.", "green");

                log("3. Buscando Configura√ß√£o da Barbearia...");
                const lojaRef = doc(db, "lojas", "barbearia_central_01");
                const lojaSnap = await getDoc(lojaRef);

                if (lojaSnap.exists()) {
                    log("‚úÖ Configura√ß√£o encontrada! O app deveria abrir.", "green");
                    log("--> O problema pode estar no c√≥digo antigo do index.html (algum erro de digita√ß√£o).", "blue");
                } else {
                    log("‚ùå Configura√ß√£o N√ÉO encontrada.", "red");
                    log("SOLU√á√ÉO: O banco est√° vazio. Voc√™ PRECISA acessar o /admin.html e clicar em SALVAR para criar a loja.", "red");
                    log(`<a href="admin.html">Clique aqui para ir ao Admin agora</a>`);
                }

            } catch (error) {
                log("‚ùå ERRO GRAVE DETECTADO:", "red");
                log(error.message, "red");
                
                if(error.message.includes("permission-denied")) {
                    log("üëâ CAUSA: Regras de Seguran√ßa bloqueadas.", "orange");
                    log("SOLU√á√ÉO: V√° no Console do Firebase > Firestore Database > Regras e mude para 'allow read, write: if true;'", "orange");
                }
                if(error.message.includes("key")) {
                     log("üëâ CAUSA: Chave de API inv√°lida.", "orange");
                }
            }
        }

        testar();
    </script>
</body>
</html>